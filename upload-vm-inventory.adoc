---
sidebar: sidebar 
permalink: upload-vm-inventory.html 
keywords: vm workloads, capture vm details 
summary: 您可以使用规划中心上传有关当前 VMware 环境的信息。 
---
= 将虚拟机库存数据上传到NetApp Workload Factory
:allow-uri-read: 
:icons: font
:imagesdir: ./media/


[role="lead"]
在创建迁移计划之前，您需要上传虚拟机库存数据。

.步骤
. 使用以下方式之一登录 Workload Factory https://docs.netapp.com/us-en/workload-setup-admin/console-experiences.html["控制台体验"^] 。
. 从 VMware 工作负载图块中，选择 *VMware 规划中心*。
+
从规划中心，您可以上传虚拟机库存数据，查看以前的库存数据上传，并使用任何虚拟机库存数据集规划迁移。

. 选择*上传虚拟机清单*。
. 选择要使用的数据收集方法：


[role="tabbed-block"]
====
.使用RVTools (快速评估)
--
RVTools是一个Windows应用程序、可与vCenter和ESX服务器(5.x到8.0)交互、以捕获有关VMware虚拟环境的信息。它可收集有关VM、CPU、内存、磁盘、集群、 ESX主机、数据存储库等。您可以将此信息导出到一个xlsx文件、以便与迁移顾问一起使用。

https://www.robware.net/home["了解有关RVTools的更多信息"^]

.步骤
. 选择 *RVTools* 图块，然后选择 *Next*。
+
此时将显示*准备AWS Cloud启用*页面。

. 输入您将创建的 VM 清单数据集的名称。
. 从下载并安装RVTools 4.4.2或更高版本 https://www.robware.net/download["RVTools网站"^]
. 启动RVTools并登录到目标vCenter Server。
+
此操作将捕获有关此vCenter Server的信息。

. 将VMware信息导出到xlsx或xls文件。
+
 https://resources.robware.net/resources/prod/RVTools.pdf["RVTools文档"^]有关详细信息、请参见中的"命令行参数"一章。

. 选择image:button-upload-file.png["上传按钮"]并选择您导出的 RVTools 文件。
. 选择*上传*。
. 选择*完成*。


--
.使用数据收集器（详细规划）
--
NetApp迁移顾问VM收集器脚本从vCenter收集VM配置信息、与RVTools收集的信息类似、但是、它会捕获当前VM性能数据、以提供实际读写IOPS和吞吐量统计信息。您可以在以下两种模式中使用该脚本：

* 每小时数据收集
* 每日数据收集


您需要启动迁移顾问才能从代码框窗口复制迁移顾问VM收集器脚本。

.开始之前
要运行收集器脚本的系统必须满足以下要求：

* 必须安装Microsoft PowerShell 7.0或更高版本。如果需要安装PowerShell、请参见 https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7.4["Microsoft PowerShell文档"^] 。
* 必须安装VMware PowerCLI。如果需要安装PowerCLI、请参见 https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.esxi.install.doc/GUID-F02D0C2D-B226-4908-9E5C-2E783D41FE2D.html["VMware PowerCLI文档"^] 。
* 必须禁用SSL证书检查。
* PowerShell必须允许运行未签名的脚本。


请注意、如果您计划从VM捕获长期统计信息(每日统计信息)、则必须在vSphere管理控制台中激活3级或以上的统计信息(VMware管理环境)。

.步骤
. 选择“*数据收集器*”图块，然后选择“*下一步*”。
+
"Code"(代码框)窗口将显示在页面右侧。

. 在代码框窗口中、选择image:button-download-codebox.png["下载按钮"]将迁移顾问数据收集器脚本(名为"list-VMs.ps1")保存到目标系统、或者选择复制此脚本以便将其粘贴到image:button-copy-codebox.png["复制按钮"]相应的系统上。
. 按照以下步骤捕获当前VM的配置：
+
.. 登录到下载了数据收集器的系统、其中安装了PowerShell和PowerCLI。
.. 运行以下命令以连接到VMware vCenter Server：
+
[source, console]
----
Connect-VIServer -server <server_IP>
----
+
将<server_IP>替换为VMware服务器的IP地址或主机名。

.. 运行已下载的数据收集器脚本、并为"ourly"或"Daily"虚拟机统计信息指定数据收集选项。
+
[source, console]
----
./list-vms.ps1 -PerformanceStatisticsTimePeriod <LastHour | LastDay>
----
+
其中：

+
*** *astHour *以20秒的间隔收集过去1小时的IOPS和吞吐量数据。
*** *astday*以5分钟为间隔收集过去24小时的IOPS和吞吐量数据。




+
或者、您也可以运行数据收集器脚本、而不指定任何选项；这样、您可以从交互式菜单中选择数据收集期间。

+
+ 脚本在当前工作目录中输出一个名称中带有时间戳的压缩文件。  .zip 文件包含所有虚拟机及其属性的列表，以及它们的 IOPS 和吞吐量数据。

. 选择*上传*。


--
.利用NetApp数据基础架构洞察力(详细规划)
--
NetApp数据基础架构洞察是一款云基础架构监控工具、可让您深入了解整个基础架构。您需要在迁移顾问和Data Infrastructure Insight之间启用临时API通信、以便迁移顾问可以收集有关VMware基础架构的信息。

https://docs.netapp.com/us-en/data-infrastructure-insights/["详细了解数据基础架构洞察力"^]

.步骤
. 选择“*Data Infrastructure Insights*”图块并选择“*下一步*”。
+
此时将显示*准备AWS Cloud启用*页面。

. 输入您将创建的 VM 清单数据集的名称。
. 输入Data Infrastructure Insights的租户端点。
+
此URL应用于访问Data Infrastructure Insight。

. 如果您尚未为Data Infrastructure Insight生成API访问令牌、请按照页面上的说明创建一个。否则，请将您的API访问令牌粘贴到*Enter API Access令牌*文本框中。
. 选择*上传*。
+
工作负载工厂从Data Infrastructure Insights收集信息。



--
====
.下一步是什么？
从规划中心管理您上传的虚拟机库存数据，或创建部署计划。

* link:explore-planning-center.html["探索 VMware 工作负载规划中心"]
* link:launch-onboarding-advisor.html["创建 Amazon VMware Cloud 部署计划"]
* link:launch-migration-advisor-evs.html["创建 Amazon Elastic VMware Service 部署计划"]
* link:launch-onboarding-advisor-native.html["创建 Amazon EC2 部署计划"]

